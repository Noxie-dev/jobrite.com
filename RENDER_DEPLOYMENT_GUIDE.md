# üöÄ JobRite Render Deployment Guide

## Current Status
- **Deployment URL**: https://jobrite-com.onrender.com/
- **Platform**: Render.com
- **Configuration**: `render.yaml` present
- **Status**: ‚ö†Ô∏è Site timing out - needs troubleshooting

## üîß Fixed Configuration Issues

### 1. Updated ALLOWED_HOSTS
Added Render domains to Django settings:
```python
ALLOWED_HOSTS.extend(['.onrender.com', '.render.com', '.vercel.app', '.now.sh'])
```

### 2. Added CSRF Trusted Origins
```python
CSRF_TRUSTED_ORIGINS = [
    'https://*.onrender.com',
    'https://*.render.com',
    # ... other platforms
]
```

### 3. WhiteNoise Configuration
Already configured for static file serving in production.

## üìã Deployment Steps

### 1. Push Latest Changes
```bash
git add .
git commit -m "Fix Render deployment configuration"
git push origin main
```

### 2. Verify Environment Variables in Render Dashboard
Go to your Render service dashboard and ensure these environment variables are set:

**Required Variables:**
```env
DEBUG=False
SECRET_KEY=[auto-generated by Render]
SUPABASE_URL=https://wmefqsnpmhbpuqybhusu.supabase.co
SUPABASE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndtZWZxc25wbWhicHVxeWJodXN1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNjYyMTQsImV4cCI6MjA3MDc0MjIxNH0.V5H-LLnIvVYQ0WvY5ftwWq5ZnFKOkPNt4czcaiuH4WM
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndtZWZxc25wbWhicHVxeWJodXN1Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NTE2NjIxNCwiZXhwIjoyMDcwNzQyMjE0fQ.M48dyDv81BMl73Df5BCopEEfStt_fOrfAMdBFRGcJBo
EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend
DEFAULT_FROM_EMAIL=JobRite Team <noreply@jobrite.com>
PYTHON_VERSION=3.12.3
```

### 3. Check Build Configuration
Your `render.yaml` should contain:
```yaml
services:
  - type: web
    name: jobrite
    env: python
    buildCommand: pip install -r requirements.txt && python manage.py collectstatic --noinput
    startCommand: gunicorn jobrite_project.wsgi:application
    envVars:
      # ... environment variables listed above
```

### 4. Manual Redeploy (if needed)
- Go to your Render dashboard
- Find the JobRite service
- Click "Manual Deploy" ‚Üí "Deploy latest commit"

## üö® Troubleshooting Current Issues

### Issue: Site Timeout
**Symptoms**: Site not loading, connection timeout
**Possible Causes**:
1. Build failure during deployment
2. Gunicorn not starting properly
3. Environment variable issues
4. Database connection problems

### Debugging Steps:

#### 1. Check Render Build Logs
- Go to Render dashboard ‚Üí Your service ‚Üí "Logs" tab
- Look for any error messages during build or runtime

#### 2. Common Error Patterns:
```bash
# Build errors
ModuleNotFoundError: No module named 'X'
# Solution: Add missing module to requirements.txt

# Static files errors
django.core.exceptions.ImproperlyConfigured: STATICFILES_STORAGE
# Solution: Ensure collectstatic runs successfully

# Database errors
django.core.exceptions.ImproperlyConfigured: database
# Solution: Check Supabase credentials

# Gunicorn errors
[CRITICAL] WORKER TIMEOUT
# Solution: Check application startup time
```

#### 3. Test Locally with Production Settings
```bash
# Set production-like environment
export DEBUG=False
export SUPABASE_URL=https://wmefqsnpmhbpuqybhusu.supabase.co
export SUPABASE_KEY=your_key_here

# Test the exact command Render uses
pip install -r requirements.txt
python manage.py collectstatic --noinput
gunicorn jobrite_project.wsgi:application
```

## üîß Quick Fixes to Try

### 1. Increase Timeout in render.yaml
```yaml
services:
  - type: web
    name: jobrite
    env: python
    buildCommand: pip install -r requirements.txt && python manage.py collectstatic --noinput
    startCommand: gunicorn jobrite_project.wsgi:application --timeout 120
```

### 2. Add Health Check Endpoint
The health check endpoint is already configured at `/health/` but make sure it's accessible.

### 3. Simplify Build Process
If build is failing, try a simpler approach:
```yaml
buildCommand: pip install -r requirements.txt && python manage.py collectstatic --noinput --clear
startCommand: gunicorn jobrite_project.wsgi:application --bind 0.0.0.0:$PORT
```

## üìä Post-Deployment Verification

Once the site is running, verify:
1. Homepage loads: https://jobrite-com.onrender.com/
2. Static files load (check browser dev tools)
3. Health check works: https://jobrite-com.onrender.com/health/
4. Admin panel accessible: https://jobrite-com.onrender.com/admin/

## üÜò If Nothing Works

### Alternative: Recreate Service
If the current deployment is completely broken:
1. Delete the current service in Render
2. Create a new service
3. Connect to your GitHub repo
4. Use auto-deploy from `main` branch
5. Set environment variables again

### Emergency Fallback
Deploy to alternative platform (Heroku, Railway) while fixing Render issues.

## üìù Next Steps

1. **Immediate**: Check Render logs for specific error messages
2. **Fix identified issues** based on log output  
3. **Redeploy** once issues are resolved
4. **Test all functionality** after successful deployment
5. **Set up monitoring** to catch future issues early

---

**Updated**: August 15, 2025  
**Status**: ‚ö†Ô∏è Investigating timeout issues
