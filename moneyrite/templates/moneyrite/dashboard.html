{% extends 'base.html' %}
{% load static %}

{% block title %}MoneyRite - Financial Dashboard{% endblock %}

{% block extra_head %}
<style>
    .moneyrite-hero {
        background: linear-gradient(135deg, var(--primary-color) 0%, #1a2d3a 100%);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
    }
    
    .financial-card {
        background: white;
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border: 1px solid #e5e7eb;
        transition: all 0.3s ease;
    }
    
    .financial-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
    }
    
    .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary-color);
    }
    
    .stat-label {
        font-size: 0.875rem;
        color: #6b7280;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
    
    .tool-card {
        background: white;
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border: 1px solid #e5e7eb;
        transition: all 0.3s ease;
        text-decoration: none;
        display: block;
        color: inherit;
    }

    .tool-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        text-decoration: none;
        color: inherit;
    }

    /* TOOLKIT TITLE CONTRAST FIX - Force white text for visibility */
    .tool-card h3 {
        color: #ffffff !important;
        font-weight: 600;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        position: relative;
        z-index: 2;
    }

    /* Ensure tool cards have dark background to match the dark-on-dark issue */
    .tool-card {
        background: var(--primary-color) !important;
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Fix other text in tool cards */
    .tool-card p {
        color: rgba(255, 255, 255, 0.8) !important;
    }

    .tool-card .text-accent {
        color: var(--accent-color) !important;
    }

    /* Dark theme toolkit cards */
    .tool-card.dark-theme {
        background: var(--primary-color);
        color: white;
    }

    .tool-card.dark-theme h3 {
        color: #ffffff !important;
    }

    .tool-card.dark-theme p {
        color: rgba(255, 255, 255, 0.8) !important;
    }
    
    .tool-icon {
        width: 48px;
        height: 48px;
        background: var(--accent-color);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
        font-size: 1.5rem;
        color: white;
    }
    
    @media (max-width: 768px) {
        .moneyrite-hero {
            padding: 1.5rem 0;
        }
        
        .stat-value {
            font-size: 1.5rem;
        }
        
        .financial-card {
            padding: 1rem;
        }
        
        .tool-card {
            padding: 1rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- MoneyRite Hero Section -->
<div class="moneyrite-hero">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center">
            <h1 class="text-3xl md:text-4xl font-bold mb-4">MoneyRite Financial Toolkit</h1>
            <p class="text-lg md:text-xl text-gray-200 max-w-2xl mx-auto">
                Take control of your finances with our South African-focused tools for salary calculations, budgeting, and debt tracking.
            </p>
        </div>
    </div>
</div>

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-12">
    <!-- Financial Overview -->
    <div class="mb-8">
        <h2 class="text-2xl font-bold text-primary mb-6">Your Financial Overview</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Net Monthly Income -->
            <div class="financial-card text-center">
                <div class="stat-value">
                    {% if latest_salary %}
                        R{{ latest_salary.net_monthly|floatformat:2 }}
                    {% else %}
                        R0.00
                    {% endif %}
                </div>
                <div class="stat-label">Net Monthly Income</div>
            </div>
            
            <!-- Budget Status -->
            <div class="financial-card text-center">
                <div class="stat-value">
                    {% if active_budget %}
                        R{{ active_budget.remaining_balance|floatformat:2 }}
                    {% else %}
                        --
                    {% endif %}
                </div>
                <div class="stat-label">Budget Balance</div>
            </div>
            
            <!-- Total Debt -->
            <div class="financial-card text-center">
                <div class="stat-value">R{{ total_debt|floatformat:2 }}</div>
                <div class="stat-label">Total Debt</div>
            </div>
            
            <!-- Monthly Debt Payments -->
            <div class="financial-card text-center">
                <div class="stat-value">R{{ total_monthly_payments|floatformat:2 }}</div>
                <div class="stat-label">Monthly Payments</div>
            </div>
        </div>
    </div>
    
    <!-- Financial Tools -->
    <div class="mb-8">
        <h2 class="text-2xl font-bold text-primary mb-6">Financial Tools</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Salary Calculator -->
            <a href="{% url 'moneyrite:salary_calculator' %}" class="tool-card">
                <div class="tool-icon">ðŸ’°</div>
                <h3 class="text-xl font-semibold mb-2">Salary & Tax Calculator</h3>
                <p class="text-gray-600 mb-4">
                    Convert between pay periods and calculate your net salary after SARS tax and UIF deductions.
                </p>
                <div class="text-accent font-medium">Calculate Now â†’</div>
            </a>
            
            <!-- Budget Planner -->
            <a href="{% url 'moneyrite:budget_planner' %}" class="tool-card">
                <div class="tool-icon">ðŸ“Š</div>
                <h3 class="text-xl font-semibold mb-2">Budget Planner</h3>
                <p class="text-gray-600 mb-4">
                    Plan your monthly expenses with South African categories including family support and black tax.
                </p>
                <div class="text-accent font-medium">Plan Budget â†’</div>
            </a>
            
            <!-- Credit Tracker -->
            <a href="{% url 'moneyrite:credit_tracker' %}" class="tool-card">
                <div class="tool-icon">ðŸ“ˆ</div>
                <h3 class="text-xl font-semibold mb-2">Credit & Debt Tracker</h3>
                <p class="text-gray-600 mb-4">
                    Track all your debts, calculate payoff times, and monitor your credit health.
                </p>
                <div class="text-accent font-medium">Track Debt â†’</div>
            </a>
        </div>
    </div>
    
    <!-- Recent Activity -->
    {% if latest_salary or active_budget or active_debts %}
    <div class="mb-8">
        <h2 class="text-2xl font-bold text-primary mb-6">Recent Activity</h2>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Latest Salary Calculation -->
            {% if latest_salary %}
            <div class="financial-card">
                <h3 class="text-lg font-semibold mb-3">Latest Salary Calculation</h3>
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span>Pay Amount:</span>
                        <span class="font-medium">R{{ latest_salary.pay_amount }} / {{ latest_salary.pay_period }}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Gross Monthly:</span>
                        <span class="font-medium">R{{ latest_salary.gross_monthly|floatformat:2 }}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Net Monthly:</span>
                        <span class="font-medium text-primary">R{{ latest_salary.net_monthly|floatformat:2 }}</span>
                    </div>
                </div>
                <div class="mt-4">
                    <a href="{% url 'moneyrite:salary_calculator' %}" class="text-accent hover:underline">
                        Update Calculation â†’
                    </a>
                </div>
            </div>
            {% endif %}
            
            <!-- Active Budget -->
            {% if active_budget %}
            <div class="financial-card">
                <h3 class="text-lg font-semibold mb-3">{{ active_budget.name }}</h3>
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span>Monthly Income:</span>
                        <span class="font-medium">R{{ active_budget.monthly_income|floatformat:2 }}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Total Expenses:</span>
                        <span class="font-medium">R{{ active_budget.total_expenses|floatformat:2 }}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Remaining:</span>
                        <span class="font-medium {% if active_budget.remaining_balance < 0 %}text-red-600{% else %}text-green-600{% endif %}">
                            R{{ active_budget.remaining_balance|floatformat:2 }}
                        </span>
                    </div>
                </div>
                <div class="mt-4">
                    <a href="{% url 'moneyrite:budget_detail' active_budget.id %}" class="text-accent hover:underline">
                        View Budget â†’
                    </a>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}
    
    <!-- Quick Actions -->
    <div class="bg-gray-50 rounded-lg p-6">
        <h2 class="text-xl font-semibold mb-4">Quick Actions</h2>
        <div class="flex flex-wrap gap-4">
            <a href="{% url 'moneyrite:salary_calculator' %}" class="btn btn-primary">
                Calculate Salary
            </a>
            <a href="{% url 'moneyrite:create_budget' %}" class="btn btn-outline">
                Create Budget
            </a>
            <a href="{% url 'moneyrite:add_debt' %}" class="btn btn-outline">
                Add Debt
            </a>
            <a href="{% url 'moneyrite:financial_profile' %}" class="btn btn-outline">
                Update Profile
            </a>
        </div>
    </div>
</div>
{% endblock %}
