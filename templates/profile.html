{% extends 'base.html' %}
{% load static %}
{% load profile_extras %}

{% block title %}{{ user.get_full_name|default:user.username }}'s Profile - JobRite.com{% endblock %}

{% block extra_head %}
<style>
/* Enhanced Profile Styles */
.profile-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(243, 239, 245, 0.95) 100%);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(254, 127, 45, 0.1);
    transition: all 0.3s ease;
}

.profile-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 20px 40px rgba(35, 61, 77, 0.12);
    border-color: rgba(254, 127, 45, 0.2);
}

.profile-avatar {
    position: relative;
    transition: all 0.3s ease;
}

.profile-avatar:hover {
    transform: scale(1.05);
}

.profile-avatar::after {
    content: '';
    position: absolute;
    inset: -4px;
    border-radius: 50%;
    background: linear-gradient(45deg, #FE7F2D, #FFD700, #FE7F2D);
    z-index: -1;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.profile-avatar:hover::after {
    opacity: 0.6;
}

.skill-tag {
    background: linear-gradient(135deg, rgba(254, 127, 45, 0.1) 0%, rgba(254, 127, 45, 0.05) 100%);
    border: 1px solid rgba(254, 127, 45, 0.2);
    transition: all 0.2s ease;
}

.skill-tag:hover {
    background: linear-gradient(135deg, rgba(254, 127, 45, 0.2) 0%, rgba(254, 127, 45, 0.1) 100%);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(254, 127, 45, 0.15);
}

.stats-card {
    background: linear-gradient(135deg, rgba(35, 61, 77, 0.05) 0%, rgba(35, 61, 77, 0.02) 100%);
    border: 1px solid rgba(35, 61, 77, 0.1);
    transition: all 0.3s ease;
}

.stats-card:hover {
    background: linear-gradient(135deg, rgba(254, 127, 45, 0.1) 0%, rgba(254, 127, 45, 0.05) 100%);
    border-color: rgba(254, 127, 45, 0.2);
    transform: translateY(-2px);
}

.progress-ring {
    transform: rotate(-90deg);
    transition: all 1s ease;
}

.progress-ring circle {
    stroke-dasharray: 283;
    stroke-dashoffset: 283;
    transition: stroke-dashoffset 1s ease;
}

.activity-item {
    position: relative;
    padding-left: 2rem;
}

.activity-item::before {
    content: '';
    position: absolute;
    left: 0.5rem;
    top: 0;
    bottom: -1rem;
    width: 2px;
    background: linear-gradient(to bottom, rgba(254, 127, 45, 0.3), transparent);
}

.activity-item:last-child::before {
    display: none;
}

.floating-action-button {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    background: linear-gradient(135deg, #FE7F2D 0%, #FF6B00 100%);
    width: 64px;
    height: 64px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 8px 25px rgba(254, 127, 45, 0.4);
    transition: all 0.3s ease;
    z-index: 100;
}

.floating-action-button:hover {
    transform: scale(1.1) translateY(-2px);
    box-shadow: 0 12px 35px rgba(254, 127, 45, 0.5);
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.animate-fade-in-up {
    animation: fadeInUp 0.8s ease forwards;
}

.stagger-1 { animation-delay: 0.1s; }
.stagger-2 { animation-delay: 0.2s; }
.stagger-3 { animation-delay: 0.3s; }
.stagger-4 { animation-delay: 0.4s; }
</style>
{% endblock %}

{% block content %}
<div class="bg-gradient-to-br from-secondary via-white to-gray-50 min-h-screen py-8">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        
        <!-- Enhanced Profile Header -->
        <div class="profile-card rounded-2xl shadow-xl p-8 mb-8 animate-fade-in-up">
            <div class="flex flex-col lg:flex-row items-start lg:items-center space-y-6 lg:space-y-0 lg:space-x-8">
                <!-- Enhanced Profile Picture -->
                <div class="flex-shrink-0">
                    <div class="profile-avatar">
                        {% if user.userprofile.profile_picture %}
                            <img src="{{ user.userprofile.profile_picture.url }}" 
                                 alt="{{ user.get_full_name|default:user.username }}" 
                                 class="w-32 h-32 rounded-full object-cover border-4 border-white shadow-lg">
                        {% else %}
                            <div class="w-32 h-32 rounded-full bg-gradient-to-br from-accent to-orange-600 flex items-center justify-center text-white text-4xl font-bold shadow-lg">
                                {{ user.first_name.0|default:user.username.0|upper }}
                            </div>
                        {% endif %}
                        <!-- Online Status Indicator -->
                        <div class="absolute -bottom-2 -right-2 w-8 h-8 bg-green-500 rounded-full border-4 border-white shadow-lg flex items-center justify-center">
                            <div class="w-3 h-3 bg-green-400 rounded-full animate-pulse"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Enhanced Profile Info -->
                <div class="flex-1 space-y-4">
                    <div class="space-y-2">
                        <h1 class="text-4xl font-bold text-primary mb-1">
                            {{ user.get_full_name|default:user.username }}
                        </h1>
                        <p class="text-lg text-accent font-medium">{{ user.userprofile.get_experience_level_display }} Professional</p>
                    </div>
                    
                    <!-- Profile Details -->
                    <div class="flex flex-wrap gap-4 text-sm text-text-secondary">
                        {% if user.userprofile.location %}
                            <div class="flex items-center space-x-2">
                                <svg class="w-4 h-4 text-accent" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path>
                                </svg>
                                <span>{{ user.userprofile.location }}</span>
                            </div>
                        {% endif %}
                        {% if user.email %}
                            <div class="flex items-center space-x-2">
                                <svg class="w-4 h-4 text-accent" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                                    <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
                                </svg>
                                <span>{{ user.email }}</span>
                            </div>
                        {% endif %}
                        <div class="flex items-center space-x-2">
                            <svg class="w-4 h-4 text-accent" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Joined {{ user.date_joined|date:"F Y" }}</span>
                        </div>
                    </div>
                    
                    <!-- Profile Completion Progress -->
                    <div class="bg-white rounded-lg p-4 border border-gray-100">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-medium text-primary">Profile Completion</span>
                            <span class="text-sm font-bold text-accent" id="completion-percentage">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-gradient-to-r from-accent to-orange-600 h-2 rounded-full transition-all duration-1000" 
                                 style="width: 0%" id="completion-bar"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="flex flex-col space-y-3 lg:flex-shrink-0">
                    {% if is_own_profile %}
                        <button id="edit-profile-btn" class="bg-gradient-to-r from-primary to-blue-700 text-white px-6 py-3 rounded-lg font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 flex items-center space-x-2">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path>
                            </svg>
                            <span>Edit Profile</span>
                        </button>
                        <button class="bg-gradient-to-r from-accent to-orange-600 text-white px-6 py-3 rounded-lg font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 flex items-center space-x-2">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Download CV</span>
                        </button>
                    {% else %}
                        <button class="bg-gradient-to-r from-accent to-orange-600 text-white px-6 py-3 rounded-lg font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 flex items-center space-x-2">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                                <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
                            </svg>
                            <span>Contact</span>
                        </button>
                        <button class="bg-gradient-to-r from-blue-500 to-blue-700 text-white px-6 py-3 rounded-lg font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 flex items-center space-x-2">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <span>Connect</span>
                        </button>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Main Content -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Enhanced About Section -->
                <div class="profile-card rounded-xl shadow-lg p-8 animate-fade-in-up stagger-1">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-primary flex items-center space-x-2">
                            <svg class="w-6 h-6 text-accent" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z" clip-rule="evenodd"></path>
                            </svg>
                            <span>About Me</span>
                        </h2>
                        {% if is_own_profile %}
                            <button class="text-accent hover:text-orange-600 transition-colors duration-200">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path>
                                </svg>
                            </button>
                        {% endif %}
                    </div>
                    {% if user.userprofile.bio %}
                        <div class="prose max-w-none">
                            <p class="text-text-secondary leading-relaxed text-lg">{{ user.userprofile.bio }}</p>
                        </div>
                    {% else %}
                        <div class="text-center py-8 border-2 border-dashed border-gray-200 rounded-lg bg-gray-50">
                            <svg class="mx-auto w-12 h-12 text-gray-300 mb-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z" clip-rule="evenodd"></path>
                            </svg>
                            <p class="text-text-secondary mb-4">Tell employers about yourself!</p>
                            {% if is_own_profile %}
                                <button class="text-accent hover:text-orange-600 font-medium transition-colors duration-200">
                                    Add your bio to stand out
                                </button>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>

                <!-- Enhanced Skills & Expertise Section -->
                <div class="profile-card rounded-xl shadow-lg p-8 animate-fade-in-up stagger-2">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-primary flex items-center space-x-2">
                            <svg class="w-6 h-6 text-accent" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Skills & Expertise</span>
                        </h2>
                        {% if is_own_profile %}
                            <button class="text-accent hover:text-orange-600 transition-colors duration-200">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"></path>
                                </svg>
                            </button>
                        {% endif %}
                    </div>
                    {% if user.userprofile.skills %}
                        <div class="flex flex-wrap gap-3">
                            {% for skill in user.userprofile.skills|split:"," %}
                                <span class="skill-tag inline-flex items-center px-4 py-2 rounded-full text-sm font-medium text-primary cursor-pointer">
                                    <svg class="w-3 h-3 mr-2 text-accent" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                    </svg>
                                    {{ skill.strip }}
                                </span>
                            {% endfor %}
                        </div>
                        <!-- Skill Progress Indicators (Placeholder) -->
                        <div class="mt-6 space-y-4">
                            <h3 class="text-lg font-semibold text-primary mb-3">Top Skills</h3>
                            {% for skill in user.userprofile.skills|split:"," %}
                                {% if forloop.counter <= 3 %}
                                    <div class="space-y-2">
                                        <div class="flex justify-between">
                                            <span class="text-sm font-medium text-primary">{{ skill.strip }}</span>
                                            <span class="text-sm text-accent font-bold">{{ forloop.counter|add:6 }}0%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-gradient-to-r from-accent to-orange-600 h-2 rounded-full transition-all duration-1000" 
                                                 style="width: {{ forloop.counter|add:6 }}0%"></div>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-center py-8 border-2 border-dashed border-gray-200 rounded-lg bg-gray-50">
                            <svg class="mx-auto w-12 h-12 text-gray-300 mb-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"></path>
                            </svg>
                            <p class="text-text-secondary mb-4">Showcase your skills!</p>
                            {% if is_own_profile %}
                                <button class="text-accent hover:text-orange-600 font-medium transition-colors duration-200">
                                    Add skills to attract employers
                                </button>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>

                <!-- Job Preferences Section -->
                {% if user.userprofile.preferred_job_categories or user.userprofile.preferred_locations %}
                <div class="profile-card rounded-xl shadow-lg p-8 animate-fade-in-up stagger-3">
                    <h2 class="text-2xl font-bold text-primary flex items-center space-x-2 mb-6">
                        <svg class="w-6 h-6 text-accent" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
                        </svg>
                        <span>Job Preferences</span>
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {% if user.userprofile.preferred_job_categories %}
                            <div>
                                <h3 class="text-lg font-semibold text-primary mb-3">Preferred Categories</h3>
                                <div class="space-y-2">
                                    {% for category in user.userprofile.preferred_job_categories %}
                                        <div class="flex items-center space-x-2">
                                            <div class="w-2 h-2 bg-accent rounded-full"></div>
                                            <span class="text-text-secondary capitalize">{{ category }}</span>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                        {% if user.userprofile.preferred_locations %}
                            <div>
                                <h3 class="text-lg font-semibold text-primary mb-3">Preferred Locations</h3>
                                <div class="space-y-2">
                                    {% for location in user.userprofile.preferred_locations %}
                                        <div class="flex items-center space-x-2">
                                            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                            <span class="text-text-secondary capitalize">{{ location }}</span>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
                {% endif %}

                <!-- Enhanced Activity Timeline -->
                <div class="profile-card rounded-xl shadow-lg p-8 animate-fade-in-up stagger-4">
                    <h2 class="text-2xl font-bold text-primary flex items-center space-x-2 mb-6">
                        <svg class="w-6 h-6 text-accent" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                        </svg>
                        <span>Activity Timeline</span>
                    </h2>
                    <div class="space-y-6">
                        <div class="activity-item">
                            <div class="flex items-start space-x-4">
                                <div class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <p class="text-primary font-medium">Profile created</p>
                                    <p class="text-sm text-text-secondary">{{ user.userprofile.created_at|date:"F j, Y" }}</p>
                                    <p class="text-sm text-text-secondary mt-1">Welcome to JobRite! Your professional journey starts here.</p>
                                </div>
                            </div>
                        </div>
                        {% if user.userprofile.updated_at != user.userprofile.created_at %}
                            <div class="activity-item">
                                <div class="flex items-start space-x-4">
                                    <div class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center">
                                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-primary font-medium">Profile updated</p>
                                        <p class="text-sm text-text-secondary">{{ user.userprofile.updated_at|date:"F j, Y" }}</p>
                                        <p class="text-sm text-text-secondary mt-1">Profile information was updated to stay current.</p>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        {% if user.userprofile.onboarding_completed %}
                            <div class="activity-item">
                                <div class="flex items-start space-x-4">
                                    <div class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-accent to-orange-600 rounded-full flex items-center justify-center">
                                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-primary font-medium">Onboarding completed</p>
                                        <p class="text-sm text-text-secondary">Profile setup finished</p>
                                        <p class="text-sm text-text-secondary mt-1">Ready to explore job opportunities!</p>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Enhanced Sidebar -->
            <div class="space-y-6">
                <!-- Enhanced Profile Stats Card -->
                <div class="stats-card rounded-xl shadow-lg p-6 animate-fade-in-up stagger-1">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold text-primary flex items-center space-x-2">
                            <svg class="w-5 h-5 text-accent" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Profile Stats</span>
                        </h3>
                    </div>
                    <div class="space-y-4">
                        <div class="flex justify-between items-center p-3 bg-white rounded-lg border border-gray-100">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                    <svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <span class="text-text-secondary font-medium">Member since</span>
                            </div>
                            <span class="text-primary font-bold">{{ user.date_joined|date:"M Y" }}</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-white rounded-lg border border-gray-100">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                    <svg class="w-4 h-4 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path>
                                        <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <span class="text-text-secondary font-medium">Profile views</span>
                            </div>
                            <span class="text-primary font-bold" id="profile-views">0</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-white rounded-lg border border-gray-100">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-accent/10 rounded-full flex items-center justify-center">
                                    <svg class="w-4 h-4 text-accent" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm2 10a1 1 0 10-2 0v3a1 1 0 102 0v-3zm2-3a1 1 0 011 1v5a1 1 0 11-2 0v-5a1 1 0 011-1zm4-1a1 1 0 10-2 0v7a1 1 0 102 0V8z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <span class="text-text-secondary font-medium">Applications</span>
                            </div>
                            <span class="text-primary font-bold" id="applications-count">0</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-white rounded-lg border border-gray-100">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                                    <svg class="w-4 h-4 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <span class="text-text-secondary font-medium">Profile Score</span>
                            </div>
                            <span class="text-accent font-bold" id="profile-score">0%</span>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Resume Section -->
                <div class="stats-card rounded-xl shadow-lg p-6 animate-fade-in-up stagger-2">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold text-primary flex items-center space-x-2">
                            <svg class="w-5 h-5 text-accent" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Resume & CV</span>
                        </h3>
                        {% if is_own_profile %}
                            <button class="text-accent hover:text-orange-600 transition-colors duration-200">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"></path>
                                </svg>
                            </button>
                        {% endif %}
                    </div>
                    {% if user.userprofile.resume %}
                        <div class="bg-gradient-to-r from-accent/10 to-orange-600/10 rounded-lg p-4 border border-accent/20">
                            <div class="flex items-center space-x-4">
                                <div class="w-12 h-12 bg-gradient-to-br from-accent to-orange-600 rounded-lg flex items-center justify-center">
                                    <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <p class="font-bold text-primary">Resume.pdf</p>
                                    <p class="text-sm text-text-secondary">Ready for download</p>
                                </div>
                                <a href="{{ user.userprofile.resume.url }}" 
                                   class="bg-white text-accent hover:text-orange-600 p-2 rounded-lg border border-accent/20 hover:bg-accent/5 transition-all duration-200">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                                    </svg>
                                </a>
                            </div>
                        </div>
                    {% else %}
                        <div class="text-center py-8 border-2 border-dashed border-gray-200 rounded-lg bg-gray-50">
                            <div class="w-16 h-16 mx-auto bg-gray-200 rounded-full flex items-center justify-center mb-4">
                                <svg class="w-8 h-8 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <p class="text-text-secondary font-medium mb-2">No resume uploaded</p>
                            <p class="text-sm text-text-secondary mb-4">Upload your resume to get noticed by employers</p>
                            {% if is_own_profile %}
                                <button class="bg-accent text-white px-4 py-2 rounded-lg hover:bg-orange-600 font-medium transition-colors duration-200">
                                    Upload Resume
                                </button>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>

                <!-- Enhanced Quick Actions -->
                <div class="stats-card rounded-xl shadow-lg p-6 animate-fade-in-up stagger-3">
                    <h3 class="text-xl font-bold text-primary flex items-center space-x-2 mb-6">
                        <svg class="w-5 h-5 text-accent" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"></path>
                        </svg>
                        <span>Quick Actions</span>
                    </h3>
                    <div class="space-y-3">
                        <a href="{% url 'jobs:search' %}" class="group flex items-center justify-between w-full p-4 bg-white rounded-lg border border-gray-100 hover:border-accent/30 hover:bg-accent/5 transition-all duration-200">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-blue-100 group-hover:bg-blue-200 rounded-lg flex items-center justify-center transition-colors duration-200">
                                    <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="font-medium text-primary">Browse Jobs</p>
                                    <p class="text-sm text-text-secondary">Find your next opportunity</p>
                                </div>
                            </div>
                            <svg class="w-5 h-5 text-gray-400 group-hover:text-accent transition-colors duration-200" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                            </svg>
                        </a>
                        <a href="{% url 'jobs:cv_creator' %}" class="group flex items-center justify-between w-full p-4 bg-white rounded-lg border border-gray-100 hover:border-accent/30 hover:bg-accent/5 transition-all duration-200">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-green-100 group-hover:bg-green-200 rounded-lg flex items-center justify-center transition-colors duration-200">
                                    <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="font-medium text-primary">Create CV</p>
                                    <p class="text-sm text-text-secondary">Build a professional CV</p>
                                </div>
                            </div>
                            <svg class="w-5 h-5 text-gray-400 group-hover:text-accent transition-colors duration-200" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                            </svg>
                        </a>
                        <a href="{% url 'jobs:salary_calculator' %}" class="group flex items-center justify-between w-full p-4 bg-white rounded-lg border border-gray-100 hover:border-accent/30 hover:bg-accent/5 transition-all duration-200">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-accent/10 group-hover:bg-accent/20 rounded-lg flex items-center justify-center transition-colors duration-200">
                                    <svg class="w-5 h-5 text-accent" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"></path>
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="font-medium text-primary">Salary Calculator</p>
                                    <p class="text-sm text-text-secondary">Check market rates</p>
                                </div>
                            </div>
                            <svg class="w-5 h-5 text-gray-400 group-hover:text-accent transition-colors duration-200" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                            </svg>
                        </a>
                        <a href="{% url 'blog:blog_list' %}" class="group flex items-center justify-between w-full p-4 bg-white rounded-lg border border-gray-100 hover:border-accent/30 hover:bg-accent/5 transition-all duration-200">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-purple-100 group-hover:bg-purple-200 rounded-lg flex items-center justify-center transition-colors duration-200">
                                    <svg class="w-5 h-5 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.255 0-2.443.29-3.5.804V12a1 1 0 11-2 0V4.804z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="font-medium text-primary">Career Advice</p>
                                    <p class="text-sm text-text-secondary">Learn and grow</p>
                                </div>
                            </div>
                            <svg class="w-5 h-5 text-gray-400 group-hover:text-accent transition-colors duration-200" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
/* Enhanced Profile Page JavaScript */
(function() {
    'use strict';
    
    // Profile completion calculation
    function calculateProfileCompletion() {
        const fields = {
            hasName: {{ user.first_name|yesno:"true,false" }},
            hasEmail: {{ user.email|yesno:"true,false" }},
            hasBio: {% if user.userprofile.bio %}true{% else %}false{% endif %},
            hasLocation: {% if user.userprofile.location %}true{% else %}false{% endif %},
            hasSkills: {% if user.userprofile.skills %}true{% else %}false{% endif %},
            hasProfilePicture: {% if user.userprofile.profile_picture %}true{% else %}false{% endif %},
            hasResume: {% if user.userprofile.resume %}true{% else %}false{% endif %},
            hasExperience: true, // Always true as it has a default
            hasPreferences: {% if user.userprofile.preferred_job_categories %}true{% else %}false{% endif %}
        };
        
        const totalFields = Object.keys(fields).length;
        const completedFields = Object.values(fields).filter(Boolean).length;
        const percentage = Math.round((completedFields / totalFields) * 100);
        
        return { percentage, completed: completedFields, total: totalFields };
    }
    
    // Animate progress bar
    function animateProgressBar(percentage) {
        const progressBar = document.getElementById('completion-bar');
        const percentageElement = document.getElementById('completion-percentage');
        
        if (progressBar && percentageElement) {
            setTimeout(() => {
                progressBar.style.width = percentage + '%';
                percentageElement.textContent = percentage + '%';
            }, 500);
        }
    }
    
    // Animate stats counters
    function animateStatsCounters() {
        const profileViews = document.getElementById('profile-views');
        const applicationsCount = document.getElementById('applications-count');
        const profileScore = document.getElementById('profile-score');
        
        // Simulate some stats (in real app, these would come from backend)
        const stats = calculateProfileCompletion();
        
        function countUp(element, target, duration = 2000) {
            if (!element) return;
            
            let start = 0;
            const range = target - start;
            const increment = target > start ? 1 : -1;
            const stepTime = Math.abs(Math.floor(duration / range));
            
            const timer = setInterval(() => {
                start += increment;
                if (element.id === 'profile-score') {
                    element.textContent = start + '%';
                } else {
                    element.textContent = start.toLocaleString();
                }
                
                if ((increment > 0 && start >= target) || (increment < 0 && start <= target)) {
                    clearInterval(timer);
                    if (element.id === 'profile-score') {
                        element.textContent = target + '%';
                    } else {
                        element.textContent = target.toLocaleString();
                    }
                }
            }, stepTime > 0 ? stepTime : 1);
        }
        
        // Animate counters with delays
        setTimeout(() => countUp(profileViews, Math.floor(Math.random() * 50) + 10), 300);
        setTimeout(() => countUp(applicationsCount, Math.floor(Math.random() * 5)), 600);
        setTimeout(() => countUp(profileScore, stats.percentage), 900);
    }
    
    // Smooth scroll to sections
    function initSmoothScrolling() {
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    }
    
    // Add hover effects for skill tags
    function initSkillTagInteractions() {
        document.querySelectorAll('.skill-tag').forEach(tag => {
            tag.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-2px) scale(1.05)';
            });
            
            tag.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
        });
    }
    
    // Handle profile picture hover effect
    function initProfilePictureEffects() {
        const profileAvatar = document.querySelector('.profile-avatar');
        if (profileAvatar) {
            profileAvatar.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.1)';
            });
            
            profileAvatar.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
        }
    }
    
    // Add floating action button
    function addFloatingActionButton() {
        const fab = document.createElement('div');
        fab.className = 'floating-action-button';
        fab.innerHTML = `
            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path>
            </svg>
        `;
        
        fab.addEventListener('click', function() {
            // Scroll to top or trigger edit mode
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
        // Only show for profile owners
        {% if is_own_profile %}
            document.body.appendChild(fab);
            
            // Show/hide based on scroll position
            let fabVisible = false;
            window.addEventListener('scroll', function() {
                const scrolled = window.pageYOffset > 300;
                if (scrolled && !fabVisible) {
                    fab.style.opacity = '1';
                    fab.style.transform = 'scale(1)';
                    fabVisible = true;
                } else if (!scrolled && fabVisible) {
                    fab.style.opacity = '0';
                    fab.style.transform = 'scale(0.8)';
                    fabVisible = false;
                }
            });
        {% endif %}
    }
    
    // Add intersection observer for animations
    function initScrollAnimations() {
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-fade-in-up');
                }
            });
        }, observerOptions);
        
        // Observe all profile cards
        document.querySelectorAll('.profile-card, .stats-card').forEach(card => {
            observer.observe(card);
        });
    }
    
    // Handle button interactions
    function initButtonInteractions() {
        // Edit profile button
        const editBtn = document.getElementById('edit-profile-btn');
        if (editBtn) {
            editBtn.addEventListener('click', function() {
                // In a real app, this would open an edit modal or navigate to edit page
                const notification = document.createElement('div');
                notification.className = 'fixed top-4 right-4 bg-accent text-white px-6 py-3 rounded-lg shadow-lg z-50';
                notification.textContent = 'Edit profile functionality would be implemented here!';
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            });
        }
        
        // Add click effects to all buttons
        document.querySelectorAll('button, .group').forEach(btn => {
            btn.addEventListener('click', function(e) {
                // Create ripple effect
                const ripple = document.createElement('span');
                const rect = this.getBoundingClientRect();
                const size = Math.max(rect.height, rect.width);
                const x = e.clientX - rect.left - size / 2;
                const y = e.clientY - rect.top - size / 2;
                
                ripple.style.position = 'absolute';
                ripple.style.width = ripple.style.height = size + 'px';
                ripple.style.left = x + 'px';
                ripple.style.top = y + 'px';
                ripple.style.background = 'rgba(255, 255, 255, 0.3)';
                ripple.style.borderRadius = '50%';
                ripple.style.transform = 'scale(0)';
                ripple.style.animation = 'ripple 0.6s linear';
                ripple.style.pointerEvents = 'none';
                
                this.style.position = 'relative';
                this.style.overflow = 'hidden';
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
        });
    }
    
    // Add ripple animation CSS
    function addRippleAnimation() {
        const style = document.createElement('style');
        style.textContent = `
            @keyframes ripple {
                to {
                    transform: scale(2);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    }
    
    // Initialize everything when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Enhanced Profile page loaded');
        
        // Calculate and animate profile completion
        const completion = calculateProfileCompletion();
        animateProgressBar(completion.percentage);
        
        // Initialize all features
        setTimeout(() => {
            animateStatsCounters();
        }, 800);
        
        initSmoothScrolling();
        initSkillTagInteractions();
        initProfilePictureEffects();
        addFloatingActionButton();
        initScrollAnimations();
        initButtonInteractions();
        addRippleAnimation();
        
        // Add some loading animations
        document.querySelectorAll('.animate-fade-in-up').forEach((element, index) => {
            element.style.animationDelay = `${0.1 * (index + 1)}s`;
        });
        
        // Log profile completion for debugging
        console.log('Profile completion:', completion);
    });
    
})();
</script>
{% endblock %}
